---
title: "Untitled"
output: github_dpcument
date: "2024-11-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(broom)
library(tidyverse)
```


```{R}
# Set parameters



power_analysis <- function(mu, n = 30, sigma = 5, alpha = 0.05, num_simulations = 5000) {
  set.seed(123)  # for reproducibility
  
  estimates <- numeric(num_simulations)
  p_values <- numeric(num_simulations)
  
  for (i in 1:num_simulations) {
    x <- rnorm(n, mean = mu, sd = sigma)
    t_test <- t.test(x, mu = 0)
    test_result <- broom::tidy(t_test)
    estimates[i] <- test_result$estimate
    p_values[i] <- test_result$p.value
  }
  
  results_df <- data.frame(estimate = estimates, p_value = p_values)
  power <- mean(results_df$p_value < alpha)
  
  return(list(estimated_power = power, results = results_df))
}

# Example usage:
result <- power_analysis(mu = 2)  # change mu to explore different values
print(result$estimated_power)

# Run simulations for a range of μ values
mu_values <- 1:6
power_values <- sapply(mu_values, power_analysis)

# Create a data frame for plotting
plot_data <- data.frame(mu = mu_values, power = power_values)

# Plotting
ggplot(plot_data, aes(x = mu, y = power)) +
  geom_line() +
  geom_point() +
  labs(x = "True Value of μ", y = "Power of the Test", title = "Power Analysis of One-Sample t-Test") +
  theme_minimal()



```